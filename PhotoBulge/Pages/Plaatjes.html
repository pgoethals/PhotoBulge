<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Plaatjes</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge;" />
    <link href="../Content/bootstrap.css" rel="stylesheet" />
    <script src="../Scripts/jquery-2.1.3.js"></script>
    
    <style>
        
    </style>

</head>
<body>
    <div class="container" id="images-page">
        <div class="page-header">
            <h2 id="description"></h2>
        </div>

        <div class="container media-body">
            <div id="errorMessage" class="alert alert-danger" style="display: none;"></div>
            <button type="button" class="btn btn-default" id="selectAll">
                <span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Alles selecteren
            </button>
            <button type="button" class="btn btn-default" id="download">
                <span class="glyphicon glyphicon-download" aria-hidden="true"></span> Download als ZIP
            </button>
            <div class="row" id="images-container">

            </div>
        </div>

        <div style="display: none;">
            <form action="../download" method="post" id="downloadForm">
                <input type="text" name="Folder" id="folder" />
                <input type="text" name="Images" id="images" />
            </form>
        </div>

        
    </div>
    
    
    <div id="ajax_loader" style="position: fixed; left: 50%; top: 50%; margin-left:-110px; display: none;">
        <img src="../content/images/ajax-loader.gif" />
    </div>
    

    <script language="javascript">
        var folder = "ardjan2015";

        $(document).ready(function () {

            $("#selectAll").click(function () {
                error();
                $(".selectImage").each(function () {
                    this.checked = true;
                });
            });

            $("#download").click(function () {
                error();
                var imagesList = Array();
                $(".selectImage").each(function () {
                    if (this.checked) {
                        imagesList.push(this.id);
                    }
                });
                if (imagesList.length == 0) {
                    error("Selecteer eerst een foto.");
                    return;
                }

                $("#folder").val(folder);
                $("#images").val(imagesList.join());
                $("#downloadForm").submit();

            });


            $.getJSON("../list/" + folder, function (list) {
                error();
                $("#description").text(list.Description);


                $.each(list.Images, function (i, image) {
                    var container = $("#container");
                    var src = "../image/" + folder + "/" + image.Name + "/small";
                    var lnk = "../image/" + folder + "/" + image.Name + "/full";
                    container.append(
                        "<div class='col-xs-6 col-md-3'><div class='input-group'>" +
                        "<input type='checkbox' class='selectImage' id='" + image.Name + "'>" +
                        "<a href='" + lnk + "' class='thumbnail'><img src='" + src + "'" + "/></a>" +
                        "</div></div>");

                });
            });

        });



        function error(message) {
            if (message) {
                $("#errorMessage").text(message);
                $("#errorMessage").show();
            } else {
                $("#errorMessage").hide();
            }
        }


        $(document).ajaxSend(function (event, request, settings) {
            $('#ajax_loader').show();
        });

        $(document).ajaxComplete(function (event, request, settings) {
            $('#ajax_loader').hide();
        });


    </script>

</body>
</html>
